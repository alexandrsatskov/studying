# Врубаем свой плейлист


## Описание
Вы когда нибудь вставали к первой паре?.. Печальное чувство, правда? Теперь можно будет ехать на учебу/работу заряженным и позитивным! (но это не точно)  
Новая SUF (super useful feature), позволяет пользователям такси выбирать в качесте опции при заказе такси свой плейлист, и слушать его во время поездки!


## Гипотеза
1. В первую очередь просто классная идея как мне кажется, учитывая параболический рост кол-ва музыки и ее производных в последние десятилетия.
Больше позитивных оценок, как пользователю, так и водителю.  
\*В данном случае предполагается, что музыка содаст позитивную, дружескую атмосферу, **НО** только в том случае, если она устраивает обе стороны С:

2. Для бизнеса можно выделить следующие пункты:
    - Из-за, возможной, позитивной атмосферы пользователи захотят оставить чаевые водителю.
    - Опция очевидно будет платная, => $$$
    - Вырастет кол-во пользователей Я.Go => $$$
    - Очевидно, что функционал, по крайней мере, на первое время, нужно будет связать с Я.Музыка, => вырастет кол-во пользователей данного сервиса, => $$$
    - Скорее всего такое событие не пройдет мимо СМИ. Так что можно как-то сыграть и на этом.
    - (субъективно) У молодежи больше лояльности к Яндексу, из-за таких нестандартных идей.


## Реализация
По идее, вся реализация заключается в добавлении нового option к уже существующим.  
Полагаю что список option'ов уже корректно обрабатывается в сервисе, и, скорее всего, ничего не сломается если добавим еще один. Следовательно, практически ничего менять/дописывать не нужно.  
Единственная проблема - добавить в приложение для водителей плеер. Который ходит в плейлист клиента и берет оттуда следующий трек.  

**Что нужно сделать**  
  - Создать новый option при оформлении заказа в Я.Go: self_playlist: bool = False
  - Модифицируем БД водителей. Добавляем новую характеристику водителя: loyal_to_client_music: bool = False (если водитель не хочет чтобы клиент включал свою музыку, в таком случае он просто не попадает в выборку, при формировании заказа с self_playlist = True)
  - В приложении для водителя создать примитивный плеер, который будет ходить в Я.Музыка API и брать оттуда треки плейлиста клиента.
  - В ручку /accept_order (водитель принял заказ) создаем/используем созданный плеера с плейлистом клиента.
  - В ручку /done_order (водитель завершил заказ) удаляем/закрываем плеер


## MVP
Можно обойтись первыми двумя пунктами из TODO, и не реализовывать плеер. В таком случае водителю нужно будет ручками открывать плейлист клиента и ручками запускать треки. Ссылку на плейлист можно засунуть в <информация о заказе>, думаю что-то подобное должно быть.


## Визуализация


## Документация API
[api.yaml](https://github.com/twinkleToes2001/studying/blob/yandex_feature/api.yaml "Swagger docs")


## Тесты 
unit:  
1. Протестировать работу плеера  
2. Протестировать что ручки /accept_order и /done_order корректно создают и закрывают/удаляют инстанс плеера  

corner case:  
1. У клиента может не быть Я.Музыки, тогда у него не должно быть возможности попробовать данную фичу  


## Как раскатываем
Включить для пользователей Я.Плюс кажется оптимальным вариантом - им приятно, что участвуют в alpha-тесте, нам - метрики. 
За чем следим:
1. Изменилось кол-во чаевых?
2. Люди стали ставить больше оценок?
3. Выросло кол-во пользователей/заказов?


## Итог  
\*Возвращаю студенческий долг. Первую ДЗ сделал по теме, которая меня особо не интересовала, а о том, чтобы придумать что-то свое даже в голову не пришло. В итоге получилось не особо качественно. Два ДЗ, так уже сделать совесть не позволяет, да и хочется получить какой-то полезный фидбек на свои попытки сделать что-то, не просто же так я тут сижу. Поэтому было принято решение сделать все с нуля, имея некоторые знания с уже прослушанных лекций. **Оригинал первого ДЗ вы найдете ниже**.  
  
\*\*Взял случай с произвольным проигрыванием треков, так как не смог придумать хорошую архитектуру для случая, когда клиент полностью контролирует music flow, т.е. сам выбирает треки, запускает, приостанавливает и т.п., подскажите как это должно выглядеть? (была идея создавать какую-то сессию между приложением музыки и приложением водителя для обмена данными(тут тогда нужно затрагивать сервис музыки, и вообще не понятно как это сделать), или сделать музыку в приложении такси (как уже сделано Я.Еда, Я.Лавка и т.п.)(ну это уже как-то странно получается, по-моему; такими темпами Я.Go превратится в сервис для сервисов))  
  
\*\*\*[Ссылка на оригинальную фичу](https://github.com/YaBackSchool2021/homework1/pull/12/files?short_path=887975f#diff-887975fae30699d64776d263e337dafe316de8870f5ad12ddfec5966a2fac092)
